"0","# function to plot correlogram"
"0","fun_cor_plot <- function(data_in, "
"0","                         p_thresh=0.1, "
"0","                         r_thresh=0.7, "
"0","                         type_in=""spearman"","
"0","                         tl_cex = 0.7,"
"0","                         save_fig = FALSE,"
"0","                         filename_out = ""Plot_Out.png"") {"
"0","  # data_in should be data.frame or data.table type object"
"0","  # set p threshold (only p's <= threshold will be plotted)"
"0","  # similar for r threshold"
"0","  # type_in can be ""pearson"" or ""spearman"""
"0","  # tl_cex controls size of variable labels"
"0","  "
"0","  cor_main <- Hmisc::rcorr(as.matrix(data_in), type = type_in)"
"0",""
"0","  # p-vales"
"0","  corP_in <- cor_main$P"
"0","  # replace NA's along diagonal of p-matrix with 0"
"0","  diag(corP_in) <- 0"
"0",""
"0",""
"0","  corR_in <- cor_main$r"
"0","  corR_in <- corR_in[apply(corP_in, 1, function(x){any(x<=p_thresh)}), ]"
"0",""
"0","  # replace values lower than R-thresh with NAs"
"0","  # corP_in[corR_in < r_thresh] = 1"
"0","  corR_in[corR_in < r_thresh] = 0"
"0",""
"0","  # plot"
"0"," plt <- corrplot::corrplot(corR_in,"
"0","            method = 'ellipse', "
"0","            type = ""lower"","
"0","            p.mat = corP_in, "
"0","            # sig.level = c(0.01, 0.05, 0.1),"
"0","            insig = ""blank"", #""n"", #insig = #,""label_sig"", #"
"0","            pch.cex = 0.3,"
"0","            tl.cex = tl_cex,"
"0","            tl.srt = 0.0001,"
"0","            na.label = ""."""
"0","         )"
"0",""
"0","  "
"0","  if(save_fig) {"
"0","    ggplot2::ggsave("
"0","      filename = filename_out,"
"0","      plot = plt,"
"0","      dpi = 300"
"0","    )"
"0","  }"
"0","  "
"0","} # end correlogram function"
"0",""
"0","data_wrk <- copy(dt_wrk_train)#[, acft_sqkm := mn_anl_acft/DRAIN_SQKM]"
"0",""
"0","fun_cor_plot(data_wrk, type_in = ""spearman"")"

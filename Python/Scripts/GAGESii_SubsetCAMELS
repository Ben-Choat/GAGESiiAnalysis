'''
BChoat 10/16/2022

Subset my data to CAMELS catchments. There are 671 
CAMELS catchments.
'''

# %%
# import libraries

import pandas as pd


# %%
# Define directories
############


dir_cam = 'D:/DataWorkingCAMELS/camels_attributes_v2.0/camels_attribues_v2.0'




# %%

# read in ID data from HPC working data and edit to have CAMELS column
df_IDtrain = pd.read_csv(
    'D:/Projects/GAGESii_ANNstuff/HPC_Files/GAGES_Work/data_work/'
    'GAGESiiVariables/ID_train.csv',
    dtype = {'STAID': 'string'}
)
df_IDvalnit = pd.read_csv(
    'D:/Projects/GAGESii_ANNstuff/HPC_Files/GAGES_Work/data_work/'
    'GAGESiiVariables/ID_valnit.csv',
    dtype = {'STAID': 'string'}
)

# read in data to see how many catchments in common there are
# camels
df_camid = pd.read_csv(
    'D:/DataWorking/CAMELS/camels_attributes_v2.0/camels_attributes_v2.0/camels_name.txt',
    dtype = {'gauge_id': 'string'},
    sep = ';')

# mine
df_gagesiitrain = pd.read_csv(
    'D:/Projects/GAGESii_ANNstuff/Data_Out/AllVars_Partitioned/ID_train.csv',
    dtype = {'STAID': 'string'}
)

df_gagesiivalnit = pd.read_csv(
    'D:/Projects/GAGESii_ANNstuff/Data_Out/AllVars_Partitioned/ID_valnit.csv',
    dtype = {'STAID': 'string'}
)

# stations in common
st_commontrain = df_camid.loc[
    df_camid['gauge_id'].isin(df_gagesiitrain['STAID']), 'gauge_id'
    ]

print(f'total stations in common: {len(st_commontrain)}')

st_commonvalnit = df_camid.loc[
    df_camid['gauge_id'].isin(df_gagesiivalnit['STAID']), 'gauge_id'
    ]

print(f'total stations in common: {len(st_commonvalnit)}')

# adding new CAMELS indicator column to ID dataframe
df_IDtrain['CAMELS'] = ''
df_IDtrain.loc[df_gagesiitrain['STAID'].isin(st_commontrain), 'CAMELS'] = 'y' 
df_IDtrain.loc[~df_gagesiitrain['STAID'].isin(st_commontrain), 'CAMELS'] = 'n'

df_IDvalnit['CAMELS'] = ''
df_IDvalnit.loc[df_gagesiivalnit['STAID'].isin(st_commonvalnit), 'CAMELS'] = 'y' 
df_IDvalnit.loc[~df_gagesiivalnit['STAID'].isin(st_commonvalnit), 'CAMELS'] = 'n'

# write csvs back to HPC directory
df_IDtrain.to_csv(
    'D:/Projects/GAGESii_ANNstuff/HPC_Files/GAGES_Work/data_work/'
    'GAGESiiVariables/ID_train.csv',
    index = False
)

# testin
df_IDtestin = df_IDtrain
df_IDtestin.to_csv(
    'D:/Projects/GAGESii_ANNstuff/HPC_Files/GAGES_Work/data_work/'
    'GAGESiiVariables/ID_testin.csv',
    index = False
)

df_IDvalnit.to_csv(
    'D:/Projects/GAGESii_ANNstuff/HPC_Files/GAGES_Work/data_work/'
    'GAGESiiVariables/ID_valnit.csv',
    index = False
)